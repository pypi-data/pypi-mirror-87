(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{181:function(e,t,n){e.exports=n(277)},186:function(e,t,n){},188:function(e,t,n){},277:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(20),c=n.n(o),i=(n(186),n(45)),l=(n(187),n(188),n(51)),s=n(278),u=n(281),d=n(288),m=n(54),f=n(161),p=function(e){return{type:"ADD_SOURCES",sources:e}},b=function(e){return{type:"SET_SELECTED_SOURCE",source:e}},g=function(e){return{type:"UPDATE_SOURCE",source:e}},h=function(e){return{type:"UPDATE_NODE",node:e}},E=function(e){return{type:"SET_OPEN_MODAL",modal:e}},v=n(23),O=n(130),j=n.n(O),y=n(148),S=function(){var e=Object(y.a)(j.a.mark((function e(t){var n,a,r,o,c,i,l,s,u,d,m;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.method,a=t.url,r=t.body,o=t.params,c=t.resolve,i=t.reject,l=t.onStart,s=t.onFinish,l&&l(),o&&(a="".concat(a,"?").concat(new URLSearchParams(o).toString())),e.prev=3,e.next=6,fetch(a,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:if((u=e.sent).ok){e.next=12;break}return e.next=10,u.json();case 10:throw d=e.sent,new Error("".concat(u.statusText,": ").concat(d.detail));case 12:return e.next=14,u.json();case 14:m=e.sent,c(m),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),i(e.t0.message);case 21:s&&s();case 22:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}(),k=function(e){try{window.open(e)}catch(t){}},w=n(287),C=n(282),x=n(179),T=n(280),P=n(295),D=n(296),L=n(279),U=n(285),_=n(74),I=n(53),N=n(290),A=n(291),R=n(292),V=n(293),z=n(294);function G(){var e=Object(l.a)(["\n  .clear-cache-button {\n    border: none;\n    background: none;\n    padding: 0;\n    margin-left: 5px;\n    cursor: pointer;\n  }\n  .cache-placeholder {\n    color: transparent;\n  }\n"]);return G=function(){return e},e}function M(){var e=Object(l.a)(['\n  margin-top: 0;\n  margin-bottom: auto;\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-gap: 5px;\n  grid-template-areas:\n    "buttons"\n    "link";\n  .node-action-buttons {\n    grid-area: "buttons";\n    align-self: end;\n    margin-left: auto;\n    margin-right: 0;\n    button {\n      margin-right: 3px;\n    }\n    button:last-child {\n      margin-right: 0px;\n    }\n  }\n  .node-action-link {\n    grid-area: "link";\n    align-self: end;\n    margin-left: auto;\n    margin-right: 0;\n  }\n  .node-action-link-placeholder {\n    color: transparent;\n  }\n']);return M=function(){return e},e}var F=function(e){var t=e.dispatch,n=e.node,o=e.page,c=e.urlProp,l=e.icon,s=Object(a.useState)(!1),u=Object(i.a)(s,2),d=u[0],f=u[1];return r.a.createElement(m.a,{icon:l,style:{display:"inline-block",textTransform:"capitalize"},size:"small",onClick:function(){S({method:"GET",url:"/node/view/".concat(n.dataId,"/"),resolve:function(e){k(e[c]),t(h(e))},reject:function(e){return t(h(Object(v.a)(Object(v.a)({},n),{},{error:e})))},onStart:function(){return f(!0)},onFinish:function(){return f(!1)}})},loading:d},o)},B=function(e){return r.a.createElement(F,Object.assign({page:"table",urlProp:"dtaleUrl",icon:r.a.createElement(N.a,null)},e))},W=function(e){return r.a.createElement(F,Object.assign({page:"charts",urlProp:"dtaleChartsUrl",icon:r.a.createElement(A.a,null)},e))},J=function(e){return r.a.createElement(F,Object.assign({page:"describe",urlProp:"dtaleDescribeUrl",icon:r.a.createElement(R.a,null)},e))},$=function(e){return r.a.createElement(F,Object.assign({page:"correlations",urlProp:"dtaleCorrelationsUrl",icon:r.a.createElement(V.a,null)},e))},q=function(e){var t=e.dispatch,n=e.node;return r.a.createElement(m.a,{size:"small",onClick:function(){k("/node/profile-report/".concat(n.dataId,"/")),S({method:"GET",url:"/node/watch-profile-report-builder/".concat(n.dataId,"/"),resolve:function(e){e.ok&&t(h(e.node))},reject:function(e){return null}})},icon:r.a.createElement(z.a,null)},"Profile")},H=function(e){var t=e.dispatch,n=e.node,o=Object(a.useState)(!1),c=Object(i.a)(o,2),l=c[0],s=c[1];return r.a.createElement(m.a,{danger:!0,size:"small",title:"shut down",onClick:function(){s(!0),S({method:"GET",url:"node/kill/".concat(n.dataId,"/"),resolve:function(e){t(h(e)),s(!1)},reject:function(e){var a=Object(v.a)(Object(v.a)({},n),{},{error:e});t(h(a)),s(!1)}})},disabled:!n.dtaleUrl,loading:l},"Shut down")},K=I.a.div(M()),Y=function(e){var t=e.settings,n=Object(_.a)(e,["settings"]);return r.a.createElement(K,null,r.a.createElement("div",{className:"node-action-buttons"},n.node.dtaleUrl?r.a.createElement(H,n):null,r.a.createElement(B,n),r.a.createElement(W,n),r.a.createElement($,n),r.a.createElement(J,n),t.disableProfileReports?null:r.a.createElement(q,n)),r.a.createElement("div",{className:"node-action-link"},n.node.dtaleUrl?r.a.createElement("a",{href:n.node.dtaleUrl,target:"_blank",rel:"noopener noreferrer"},n.node.dtaleUrl):r.a.createElement("div",{className:"node-action-link-placeholder"},"...")))},Q=I.a.div(G()),X=function(e){var t=e.dispatch,n=e.node;return r.a.createElement(Q,null,n.lastCachedAt?r.a.createElement(a.Fragment,null,r.a.createElement(C.a.Text,{type:"secondary"},"Cached at ".concat(new Date(n.lastCachedAt).toLocaleString())),r.a.createElement("button",{className:"clear-cache-button",onClick:function(){S({method:"GET",url:"/node/clear-cache/".concat(n.dataId,"/"),resolve:function(e){t(h(e))},reject:function(e){t(h(Object(v.a)(Object(v.a)({},n),{},{error:e})))}})}},r.a.createElement(C.a.Text,{type:"danger",underline:!0,className:"clear-cache-button"},"clear cache"))):r.a.createElement("div",{className:"cache-placeholder"},"..."))},Z=function(e){var t=e.nodes,n=e.settings,o=e.dispatch,c=Object(a.useState)(""),l=Object(i.a)(c,2),s=l[0],u=l[1];return r.a.createElement(L.b,{size:"small",header:t.length<10?null:r.a.createElement(U.a.Search,{style:{marginTop:"10px",marginBottom:"10px"},placeholder:"filter",allowClear:!0,onSearch:function(e){return u(e)}}),bordered:!0,dataSource:t.filter((function(e){return e.visible&&(""===s||e.path.includes(s))})),renderItem:function(e){return r.a.createElement(L.b.Item,{actions:[r.a.createElement(Y,{settings:n,dispatch:o,node:e})]},r.a.createElement(L.b.Item.Meta,{title:r.a.createElement(C.a.Text,{ellipsis:!0,style:{maxWidth:"100%"}},e.path),description:e.error?r.a.createElement(C.a.Text,{type:"danger",strong:!0,ellipsis:!0,style:{maxWidth:"100%"}},e.error):r.a.createElement(X,{node:e,dispatch:o})}))}})};function ee(){var e=Object(l.a)(["\n  margin-right: 0;\n"]);return ee=function(){return e},e}var te=Object(I.a)(w.a)(ee()),ne=function(e){var t=e.source,n=Object.values(t.nodes||{}),a=n.filter((function(e){return e.dtaleUrl})).length;return r.a.createElement(d.b,{size:"small"},r.a.createElement(C.a.Text,{ellipsis:!0},t.name),t.loading?null:r.a.createElement(te,null,"".concat(n.length," results")),t.loading||0===a?null:r.a.createElement(te,{color:"green"},"".concat(a," active")),t.loading||!t.error?null:r.a.createElement(w.a,{color:"error"},r.a.createElement(x.a,{content:t.error},"Error")))},ae=function(e){var t=e.sources,n=e.settings,o=e.dispatch,c=function(e){o(g(Object(v.a)(Object(v.a)({},e),{},{loading:!0}))),S({method:"POST",url:"/source/nodes/list/",body:e,resolve:function(e){return o(g(Object(v.a)(Object(v.a)({},e),{},{loading:!1})))},reject:function(t){return o(g(Object(v.a)(Object(v.a)({},e),{},{loading:!1,error:t})))}})};return Object(a.useEffect)((function(){t.forEach((function(e){e.loading||e.nodesFullyLoaded||e.error||0!==Object.keys(e.nodes||{}).length||c(e)}))})),r.a.createElement(T.a,{defaultActiveKey:[]},t.filter((function(e){return e.visible})).map((function(e){return r.a.createElement(T.a.Panel,{id:e.id,key:e.id,disabled:e.loading,header:r.a.createElement(ne,{source:e}),extra:r.a.createElement(d.b,null,e.nodesFullyLoaded||e.error?null:r.a.createElement(m.a,{size:"small",icon:r.a.createElement(P.a,null),loading:e.loading,onClick:function(t){t.stopPropagation(),c(e)}},"Load more"),r.a.createElement(m.a,{icon:r.a.createElement(D.a,null),onClick:function(t){t.stopPropagation(),o(b(e))}},"Settings"))},r.a.createElement(Z,{settings:n,nodes:Object.values(e.nodes||{}),dispatch:o}))})))},re=n(284),oe=n(286),ce=n(178),ie=n(297),le=n(165),se=n.n(le),ue=(n(266),n(267),function(e){var t=e.name,n=e.value,a=e.onChange,o=e.width,c=e.theme,i=void 0===c?"monokai":c,l=e.maxLines,s=void 0===l?20:l,u=e.minLines,d=void 0===u?4:u,m=e.editorProps,f=void 0===m?{$blockScrolling:!0}:m,p=e.wrapEnabled,b=void 0===p||p,g=Object(_.a)(e,["name","value","onChange","width","theme","maxLines","minLines","editorProps","wrapEnabled"]);return r.a.createElement(se.a,Object.assign({mode:"python",name:t,value:n,onChange:a,width:o,theme:i,maxLines:s,minLines:d,editorProps:f,wrapEnabled:b},g))});function de(){var e=Object(l.a)(["\n  margin-top: 5;\n  margin-bottom: 5;\n"]);return de=function(){return e},e}var me=I.a.div(de()),fe=function(e){var t=e.source,n=e.clone,o=e.mode,c=e.dispatch,l=Object(a.useState)(null),s=Object(i.a)(l,2),u=s[0],d=s[1],f=function(){var e=["name","listPaths","getData"],a=e.filter((function(e){return!n[e]}));return a.length>0?(d("Fill out the required fields: ".concat(a.join(", "))),!1):"edit"!==o||!e.every((function(e){return n[e]===t[e]}))||(d("No changes were made"),!1)};return r.a.createElement(re.a,{title:"new"===o?"Add Data Source":"Data Source",width:800,onClose:function(){return c(b(null))},visible:!0},u?r.a.createElement(oe.a,{type:"error",message:u,closable:!0,onClose:function(){return d(null)}}):null,"new"===o?null:r.a.createElement(U.a,{style:{marginTop:5,marginBottom:5},disabled:!0,defaultValue:n.packagePath,size:"small",addonBefore:"Package",addonAfter:r.a.createElement(ie.a,{onClick:function(){return navigator.clipboard.writeText(n.packagePath).then((function(){return ce.a.open({message:"Copied to clipboard!",duration:1})}))}})}),r.a.createElement(U.a,{style:{marginTop:5,marginBottom:5},addonBefore:"Name",disabled:!t.editable,defaultValue:n.name,onChange:function(e){n.name=e.target.value},size:"small"}),r.a.createElement(me,null,"list_paths.py"),r.a.createElement(ue,{readOnly:!t.editable,name:"list_paths_code",value:n.listPaths,onChange:function(e){n.listPaths=e},width:"720",maxLines:16,minLines:16}),r.a.createElement(me,null,"get_data.py"),r.a.createElement(ue,{readOnly:!t.editable,name:"get_data_code",value:n.getData,onChange:function(e){n.getData=e},width:"720",maxLines:16,minLines:16}),t.editable?r.a.createElement(m.a,{type:"primary",block:!0,style:{marginTop:10},onClick:function(){"new"===o?function(){if(f()){n.nodes;var e=Object(_.a)(n,["nodes"]);S({method:"POST",url:"/source/create/",body:e,resolve:function(e){c(p([e])),c(b(null))},reject:function(e){return d(e)}})}}():function(){if(f()){n.nodes;var e=Object(_.a)(n,["nodes"]);S({method:"POST",url:"/source/update/",body:e,resolve:function(e){c(g(e)),c(b(null))},reject:function(e){return d(e)}})}}()}},"new"===o?"Create source":"Save changes"):null)},pe=function(e){var t=e.source,n=e.dispatch;return r.a.createElement(fe,{source:t,clone:Object(v.a)({},t),mode:""!==t.name?"edit":"new",dispatch:n})},be=n(104),ge=n(283),he=n(289),Ee=n(124);function ve(){var e=Object(l.a)(["\n  display: flex;\n  padding: 10px;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  &:hover {\n    background-color: #d3ecfa;\n  }\n  .visibility-toggle {\n    margin-left: auto;\n  }\n"]);return ve=function(){return e},e}function Oe(){var e=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n  border: 1px solid lightgray;\n  div {\n    border-bottom: 1px solid lightgray;\n  }\n  div:last-child {\n    border-bottom: none;\n  }\n"]);return Oe=function(){return e},e}var je=I.a.div(Oe()),ye=I.a.div(ve()),Se=function(e){var t=e.state,n=e.clone,a=e.dispatch,o=e.updateClone;return r.a.createElement(ge.a,{visible:"layoutEditor"===t.openModal,title:"Edit Layout",onCancel:function(){return a(E(null))},destroyOnClose:!0,width:"90%",bodyStyle:{height:"80vh",overflowY:"scroll"},centered:!0,onOk:function(){return function(){var e=n.sources.filter((function(e){var n=t.sources.find((function(t){return t.id===e.id}));return e.sortValue!==n.sortValue||e.visible!==n.visible})).map((function(e){return{id:e.id,visible:e.visible,sortValue:e.sortValue}}));e.length>0&&S({method:"POST",url:"/source/update-layout/",body:e,resolve:function(e){e.forEach((function(e){return a(g(e))})),a(E(null))},reject:function(e){return null}})}()}},r.a.createElement(Ee.a,{onDragEnd:function(e){e.destination&&function(e,t,a){var r=Object(be.cloneDeep)(e),c=r.splice(t,1),l=Object(i.a)(c,1)[0];r.splice(a,0,l),r.forEach((function(t,n){t.sortValue=e[n].sortValue})),o(Object(v.a)(Object(v.a)({},n),{},{sources:r}))}(n.sources,e.source.index,e.destination.index)}},r.a.createElement(Ee.c,{droppableId:"editLayoutSourceList"},(function(e,t){return r.a.createElement(je,Object.assign({id:"editLayoutSourceList"},e.droppableProps,{ref:e.innerRef}),n.sources.map((function(e,t){return r.a.createElement(Ee.b,{key:e.id,draggableId:e.id,index:t},(function(t,a){return r.a.createElement(ye,Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{style:a.isDragging?Object(v.a)(Object(v.a)({},t.draggableProps.style),{},{background:"#bae7ff"}):t.draggableProps.style}),e.name,r.a.createElement(he.a,{className:"visibility-toggle",checked:e.visible,onChange:function(){return function(e){e.visible=!e.visible,o(Object(be.cloneDeep)(n))}(e)},checkedChildren:"visible",unCheckedChildren:"hidden"}))}))})),e.placeholder)}))))},ke=function(e){var t=e.state,n=e.dispatch,o=Object(a.useState)(Object(be.cloneDeep)(t)),c=Object(i.a)(o,2),l=c[0],s=c[1];return Object(a.useEffect)((function(){"layoutEditor"===t.openModal&&s(Object(be.cloneDeep)(t))}),[t.openModal]),void 0===t.sources||0===t.sources.length?null:r.a.createElement(Se,{state:t,clone:l,dispatch:n,updateClone:s})};function we(){var e=Object(l.a)(["\n  width: 95vw;\n  margin: 0 auto;\n  min-height: 100vh;\n  margin-bottom: 20px;\n"]);return we=function(){return e},e}var Ce=s.a.Content,xe=Object(I.a)(Ce)(we()),Te=function(e){var t,n=e.state,a=e.dispatch,o=void 0!==n.settings&&void 0!==n.sources,c=void 0!==n.sources&&n.sources.length>0;return r.a.createElement(s.a,null,r.a.createElement(xe,null,r.a.createElement(u.a,{title:"D-Tale Desktop",subTitle:"",extra:r.a.createElement(d.b,null,o&&c&&!(null===(t=n.settings)||void 0===t?void 0:t.disableEditLayout)?r.a.createElement(m.a,{onClick:function(){return a(E("layoutEditor"))}},"Edit Layout"):null,o&&!n.settings.disableAddDataSources?r.a.createElement(m.a,{type:"primary",onClick:function(){return a(b({id:"",name:"",packageName:"",packagePath:"",nodes:void 0,nodesFullyLoaded:!1,error:null,visible:!0,editable:!0,listPaths:'from typing import Iterable\n\n\ndef main() -> Iterable[str]:\n    """\n    Return an iterable of paths identifying where data is located, such as file paths or URLs.\n    These paths will be passed to your function in get_data.py.\n    """\n    raise NotImplementedError()\n',getData:'import pandas as pd\n\n\ndef main(path: str) -> pd.DataFrame:\n    """\n    Given a path, retrieve that data and return it as a pandas dataframe\n    """\n    raise NotImplementedError()\n',saveData:""}))}},"Add Data Source"):null)}),o?r.a.createElement(ae,{settings:n.settings,sources:n.sources,dispatch:a}):r.a.createElement(f.a,null),o&&n.selectedSource?r.a.createElement(pe,{source:n.selectedSource,dispatch:a}):null,o&&c&&!n.settings.disableEditLayout?r.a.createElement(ke,{state:n,dispatch:a}):null))},Pe=n(174),De=function(e){return Object(Pe.a)(e).sort((function(e,t){return e.sortValue-t.sortValue}))},Le=function(e,t){switch(t.type){case"ADD_SOURCES":return Object(v.a)(Object(v.a)({},e),{},{sources:De(t.sources.concat(e.sources||[]))});case"SET_SELECTED_SOURCE":return Object(v.a)(Object(v.a)({},e),{},{selectedSource:t.source});case"UPDATE_SOURCE":return Object(v.a)(Object(v.a)({},e),{},{sources:De(e.sources.map((function(e){return e.id===t.source.id?t.source:e})))});case"UPDATE_NODE":return Object(v.a)(Object(v.a)({},e),{},{sources:e.sources.map((function(e){return e.id===t.node.sourceId?(n=e,a=t.node,Object(v.a)(Object(v.a)({},n),{},{nodes:Object.fromEntries(Object.entries(n.nodes||{}).map((function(e){var t=Object(i.a)(e,2),n=t[0],r=t[1];return r.dataId===a.dataId?[n,a]:[n,r]})))})):e;var n,a}))});case"SET_OPEN_MODAL":return Object(v.a)(Object(v.a)({},e),{},{openModal:t.modal});case"UPDATE_SETTINGS":return Object(v.a)(Object(v.a)({},e),{},{settings:t.settings});default:return Object(v.a)(Object(v.a)({},e),{},{sources:e.sources||[]})}},Ue={sources:void 0,selectedSource:null,openModal:null,settings:void 0,error:null},_e=function(){var e=Object(a.useReducer)(Le,Ue),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){void 0===n.sources&&S({method:"GET",url:"/source/list/",resolve:function(e){return o(p(e))},reject:function(e){return null}}),void 0===n.settings&&S({method:"GET",url:"/settings/",resolve:function(e){return o(function(e){return{type:"UPDATE_SETTINGS",settings:e}}(e))},reject:function(e){return null}})}),[]),r.a.createElement(Te,{state:n,dispatch:o})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_e,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[181,1,2]]]);
//# sourceMappingURL=main.c5cfbecc.chunk.js.map