(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{167:function(e,t,n){e.exports=n(268)},172:function(e,t,n){},174:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(26),c=n.n(o),i=(n(172),n(45)),u=n(269),l=n(271),s=n(280),d=n(46),f=n(137),m=(n(173),n(174),n(27)),h=function(e){return{type:"ADD_SOURCES",sources:e}},p=function(e){return{type:"SET_SELECTED_SOURCE",source:e}},b=function(e){return{type:"UPDATE_SOURCE",source:e}},E=function(e){return{type:"UPDATE_NODE",node:e}},v=function(e){return{type:"SET_OPEN_MODAL",modal:e}},O=n(117),g=n.n(O),j=n(136),y=function(){var e=Object(j.a)(g.a.mark((function e(t){var n,a,r,o,c,i,u,l,s,d,f;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.method,a=t.url,r=t.body,o=t.params,c=t.resolve,i=t.reject,u=t.onStart,l=t.onFinish,u&&u(),o&&(a="".concat(a,"?").concat(new URLSearchParams(o).toString())),e.prev=3,e.next=6,fetch(a,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.json();case 10:throw d=e.sent,new Error("".concat(s.statusText,": ").concat(d.detail));case 12:return e.next=14,s.json();case 14:f=e.sent,c(f),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),i(e.t0.message);case 21:l&&l();case 22:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}(),_=n(279),S=n(165),w=n(278),k=n(272),C=n(270),T=n(284),P=n(281),D=n(282),L=n(283),x=function(e){var t=e.dispatch,n=e.node,o=e.page,c=void 0===o?"table":o,u=Object(a.useState)(!1),l=Object(i.a)(u,2),s=l[0],f=l[1];return r.a.createElement(d.a,{onClick:function(){y({method:"POST",url:"/node/view/",body:n,resolve:function(e){!function(e){try{window.open(e)}catch(t){}}("charts"===c?e.dtaleChartsUrl:e.dtaleUrl),t(E(e))},reject:function(e){return t(E(Object(m.a)(Object(m.a)({},n),{},{error:e})))},onStart:function(){return f(!0)},onFinish:function(){return f(!1)}})},loading:s,icon:"charts"===c?r.a.createElement(P.a,null):r.a.createElement(D.a,null)},"".concat("charts"===c?"Charts":"Table"))},U=function(e){var t=e.dispatch,n=e.node;return r.a.createElement(x,{dispatch:t,node:n,page:"table"})},N=function(e){var t=e.dispatch,n=e.node;return r.a.createElement(x,{dispatch:t,node:n,page:"charts"})},I=function(e){var t=e.dispatch,n=e.node,o=Object(a.useState)(!1),c=Object(i.a)(o,2),u=c[0],l=c[1];return r.a.createElement(d.a,{title:"shut down",onClick:function(){l(!0),y({method:"POST",url:"node/kill/",body:n,resolve:function(e){t(E(e)),l(!1)},reject:function(e){var a=Object(m.a)(Object(m.a)({},n),{},{error:e});t(E(a)),l(!1)}})},disabled:!n.dtaleUrl,loading:u,icon:r.a.createElement(L.a,null)})},A=function(e){var t=e.source;return r.a.createElement(_.a,null,t.loading?r.a.createElement(f.a,{size:"small"}):"".concat(Object.keys(t.nodes||{}).length," results"))},M=function(e){var t=e.source,n=Object.values(t.nodes||{}).filter((function(e){return e.dtaleUrl})).length;return 0===n?null:r.a.createElement(_.a,{color:"green"},"".concat(n," active"))},R=function(e){var t=e.source;return t.error?r.a.createElement(_.a,{color:"error"},r.a.createElement(S.a,{content:t.error},"Error")):null},F=function(e){var t=e.source,n=e.loadMore;return t.nodesFullyLoaded||t.loading||t.error?null:r.a.createElement(d.a,{size:"small",onClick:function(e){e.stopPropagation(),n(t)}},"Load more")},B=function(e){var t=e.node,n=e.dispatch;return t.error?r.a.createElement(w.a,{type:"error",message:t.error,closable:!0,onClose:function(){return n(E(Object(m.a)(Object(m.a)({},t),{},{error:void 0})))}}):t.dtaleUrl?r.a.createElement("a",{href:t.dtaleUrl,target:"_blank",rel:"noopener noreferrer"},t.dtaleUrl):null},z=function(e){var t=e.sources,n=e.dispatch,o=function(e){n(b(Object(m.a)(Object(m.a)({},e),{},{loading:!0}))),y({method:"POST",url:"/source/nodes/list/",body:e,resolve:function(e){return n(b(Object(m.a)(Object(m.a)({},e),{},{loading:!1})))},reject:function(t){return n(b(Object(m.a)(Object(m.a)({},e),{},{loading:!1,error:t})))}})},c=function(e){return e.visible};return Object(a.useEffect)((function(){t.forEach((function(e){e.loading||e.nodesFullyLoaded||e.error||0!==Object.keys(e.nodes||{}).length||o(e)}))})),r.a.createElement(k.a,{defaultActiveKey:[]},t.filter((function(e){return e.visible})).map((function(e){return r.a.createElement(k.a.Panel,{key:e.id,style:e.visible?{}:{color:"lightgray"},disabled:e.loading,header:r.a.createElement(s.b,null,r.a.createElement("span",null,e.name),r.a.createElement(A,{source:e}),r.a.createElement(M,{source:e}),r.a.createElement(R,{source:e}),r.a.createElement(F,{source:e,loadMore:o})),extra:r.a.createElement(s.b,null,r.a.createElement(d.a,{icon:r.a.createElement(T.a,null),onClick:function(t){t.stopPropagation(),n(p(e))}},"Settings"))},r.a.createElement(C.b,{size:"small",bordered:!0,dataSource:Object.values(e.nodes||{}).filter(c),renderItem:function(e){return r.a.createElement(C.b.Item,{actions:[r.a.createElement(I,{dispatch:n,node:e}),r.a.createElement(U,{dispatch:n,node:e}),r.a.createElement(N,{dispatch:n,node:e})]},r.a.createElement(C.b.Item.Meta,{title:e.path,description:r.a.createElement(B,{node:e,dispatch:n})}))}}))})))},W=n(93),J=n(276),K=n(274),V=n(275),G=n(285),$=n(148),q=n.n($),H=(n(242),n(243),function(e){var t=e.name,n=e.value,a=e.onChange,o=e.width,c=e.theme,i=void 0===c?"monokai":c,u=e.maxLines,l=void 0===u?20:u,s=e.minLines,d=void 0===s?4:s,f=e.editorProps,m=void 0===f?{$blockScrolling:!0}:f,h=e.wrapEnabled,p=void 0===h||h,b=Object(W.a)(e,["name","value","onChange","width","theme","maxLines","minLines","editorProps","wrapEnabled"]);return r.a.createElement(q.a,Object.assign({mode:"python",name:t,value:n,onChange:a,width:o,theme:i,maxLines:l,minLines:d,editorProps:m,wrapEnabled:p},b))}),Q=function(e){var t=e.text;return r.a.createElement("div",{style:{marginTop:5,marginBottom:5}},t)},X=function(e){var t=e.source,n=e.dispatch,o=Object(a.useState)(null),c=Object(i.a)(o,2),u=c[0],l=c[1],s=""!==t.name?"edit":"new",f=Object(m.a)({},t),E=function(){var e=["name","listPaths","getData"],n=e.filter((function(e){return!f[e]}));return n.length>0?(l("Fill out the required fields: ".concat(n.join(", "))),!1):"edit"!==s||!e.every((function(e){return f[e]===t[e]}))||(l("No changes were made"),!1)};return r.a.createElement(J.a,{title:"new"===s?"Add Data Source":"Edit Data Source",width:800,onClose:function(){return n(p(null))},visible:!0},u?r.a.createElement(w.a,{type:"error",message:u,closable:!0,onClose:function(){return l(null)}}):null,"new"===s?null:r.a.createElement(K.a,{style:{marginTop:5,marginBottom:5},disabled:!0,defaultValue:f.packagePath,size:"small",addonBefore:"Package",addonAfter:r.a.createElement(G.a,{onClick:function(){return navigator.clipboard.writeText(f.packagePath).then((function(){return V.a.open({message:"Copied to clipboard!",duration:1})}))}})}),r.a.createElement(K.a,{style:{marginTop:5,marginBottom:5},addonBefore:"Name",disabled:!t.editable,defaultValue:f.name,onChange:function(e){f.name=e.target.value},size:"small"}),r.a.createElement(Q,{text:"list_paths.py"}),r.a.createElement(H,{readOnly:!t.editable,name:"list_paths_code",value:f.listPaths,onChange:function(e){f.listPaths=e},width:"720",maxLines:16,minLines:16}),r.a.createElement(Q,{text:"get_data.py"}),r.a.createElement(H,{readOnly:!t.editable,name:"get_data_code",value:f.getData,onChange:function(e){f.getData=e},width:"720",maxLines:16,minLines:16}),t.editable?r.a.createElement(d.a,{type:"primary",block:!0,style:{marginTop:10},onClick:function(){"new"===s?function(){if(E()){f.nodes;var e=Object(W.a)(f,["nodes"]);y({method:"POST",url:"/source/create/",body:e,resolve:function(e){n(h([e])),n(p(null))},reject:function(e){return l(e)}})}}():function(){if(E()){f.nodes;var e=Object(W.a)(f,["nodes"]);y({method:"POST",url:"/source/update/",body:e,resolve:function(e){n(b(e)),n(p(null))},reject:function(e){return l(e)}})}}()}},"new"===s?"Create source":"Save changes"):null)},Y=n(83),Z=n(273),ee=n(277),te=function(e){return"".concat("___source___").concat(e.id)},ne=function(e){return"".concat("___node___").concat(e.dataId)},ae=function(e){return e.startsWith("___source___")},re=function(e){return e.startsWith("___node___")},oe=function(e,t){var n=t.slice("___source___".length);return(e.sources||[]).find((function(e){return e.id===n}))},ce=function(e,t){var n=t.slice("___node___".length);return e.sources.find((function(e){return n in(e.nodes||{})})).nodes[n]},ie=function(e,t,n){return t.filter((function(e){return ae(e)&&!n.includes(e)})).map((function(t){return oe(e,t)}))},ue=function(e,t,n){return n.filter((function(e){return ae(e)&&!t.includes(e)})).map((function(t){return oe(e,t)}))},le=function(e,t,n){return t.filter((function(e){return re(e)&&!n.includes(e)})).map((function(t){return ce(e,t)}))},se=function(e,t,n){return n.filter((function(e){return re(e)&&!t.includes(e)})).map((function(t){return ce(e,t)}))},de=function(e){return(e.sources||[]).map((function(e){return{title:e.name,key:te(e),isLeaf:0===Object.keys(e.nodes||{}).length,children:Object.values(e.nodes||{}).map((function(e){return{title:e.path,key:ne(e),isLeaf:!0}}))}}))},fe=function(e,t){var n=[],a=[];return t.forEach((function(t){if(re(t))n.push(t);else{var r=oe(e,t);Object.values(r.nodes||{}).every((function(e){return e.visible}))?n.push(t):a.push(t)}})),{checked:n,halfChecked:a}},me=function(e){var t=e.state,n=e.dispatch,o=Object(a.useState)([]),c=Object(i.a)(o,2),u=c[0],l=c[1],s=Object(a.useState)([]),d=Object(i.a)(s,2),f=d[0],m=d[1];Object(a.useEffect)((function(){var e=function(e){var t=[];return(e.sources||[]).filter((function(e){return e.visible})).forEach((function(e){t.push(te(e)),Object.values(e.nodes||{}).filter((function(e){return e.visible})).forEach((function(e){t.push(ne(e))}))})),t}(t);l(e),m(e)}),[t.openModal]);var h=function(){var e=function(e,t,n){return{showSources:ue(e,t,n),hideSources:ie(e,t,n),showNodes:se(e,t,n),hideNodes:le(e,t,n)}}(t,u,f);y({method:"POST",url:"/update-filters/",body:{showSources:e.showSources.map((function(e){return e.id})),hideSources:e.hideSources.map((function(e){return e.id})),showNodes:e.showNodes.map((function(e){return e.dataId})),hideNodes:e.hideNodes.map((function(e){return e.dataId}))},resolve:function(e){e.forEach((function(e){n(b(e))}))},reject:function(e){return null},onFinish:function(){return n(v(null))}})};return r.a.createElement(Z.a,{visible:"filters"===t.openModal,title:"Visible Sources",onCancel:function(){return n(v(null))},destroyOnClose:!0,width:"90%",bodyStyle:{height:"80vh"},centered:!0,onOk:function(){return h()}},r.a.createElement(ee.a,{treeData:de(t),defaultCheckedKeys:fe(t,u),blockNode:!0,checkable:!0,onCheck:function(e,t){m([].concat(Object(Y.a)(e),Object(Y.a)(t.halfCheckedKeys||[])))}}))};function he(e,t){switch(t.type){case"ADD_SOURCES":return Object(m.a)(Object(m.a)({},e),{},{sources:[].concat(Object(Y.a)(t.sources),Object(Y.a)(e.sources||[]))});case"SET_SELECTED_SOURCE":return Object(m.a)(Object(m.a)({},e),{},{selectedSource:t.source});case"UPDATE_SOURCE":return Object(m.a)(Object(m.a)({},e),{},{sources:e.sources.map((function(e){return e.id===t.source.id?t.source:e}))});case"UPDATE_NODE":return Object(m.a)(Object(m.a)({},e),{},{sources:e.sources.map((function(e){return e.id===t.node.sourceId?(n=e,a=t.node,Object(m.a)(Object(m.a)({},n),{},{nodes:Object.fromEntries(Object.entries(n.nodes||{}).map((function(e){var t=Object(i.a)(e,2),n=t[0],r=t[1];return r.dataId===a.dataId?[n,a]:[n,r]})))})):e;var n,a}))});case"SET_OPEN_MODAL":return Object(m.a)(Object(m.a)({},e),{},{openModal:t.modal});default:return Object(m.a)(Object(m.a)({},e),{},{sources:e.sources||[]})}}var pe={sources:void 0,selectedSource:null,openModal:null},be=u.a.Content,Ee=function(){var e=Object(a.useReducer)(he,pe),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){y({method:"GET",url:"/source/list/",resolve:function(e){return o(h(e))},reject:function(e){return null}})}),[]),r.a.createElement(u.a,null,r.a.createElement(be,{style:{width:"95vw",margin:"0 auto",minHeight:"100vh"}},r.a.createElement(l.a,{title:"D-Tale Desktop",className:"site-page-header",subTitle:"",extra:r.a.createElement(s.b,null,r.a.createElement(d.a,{onClick:function(){o(v("filters"))}},"Filters"),r.a.createElement(d.a,{type:"primary",onClick:function(){o(p({id:"",name:"",packageName:"",packagePath:"",nodes:void 0,nodesFullyLoaded:!1,error:null,visible:!0,editable:!0,listPaths:'from typing import Iterable\n\n\ndef main() -> Iterable[str]:\n    """\n    Return an iterable of paths identifying where data is located, such as file paths or URLs.\n    These paths will be passed to your function in get_data.py.\n    """\n    raise NotImplementedError()\n',getData:'import pandas as pd\n\n\ndef main(path: str) -> pd.DataFrame:\n    """\n    Given a path, retrieve that data and return it as a pandas dataframe\n    """\n    raise NotImplementedError()\n',saveData:""}))}},"Add Data Source"))}),r.a.createElement("div",{style:{width:"100%"}},void 0===n.sources?r.a.createElement(f.a,null):r.a.createElement(z,{sources:n.sources,dispatch:o})),n.selectedSource?r.a.createElement(X,{source:n.selectedSource,dispatch:o}):null,r.a.createElement(me,{state:n,dispatch:o})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[167,1,2]]]);
//# sourceMappingURL=main.1191e43e.chunk.js.map