[tox]
envlist = py27,py36,py37,flake8,doc

[testenv]
skip_install = True
parallel_show_output = True
basepython=
    py27: {env:TOXPYTHON:python2.7}
    py36: {env:TOXPYTHON:python3.6}
    py37: {env:TOXPYTHON:python3.7}
    flake8: {env:TOXPYTHON:python3.7}
    flake8python2: {env:TOXPYTHON:python2.7}

deps =
    rpm-py-installer
    -r{toxinidir}/requirements/pypi.txt
    -r{toxinidir}/requirements/test-pypi.txt

commands =
    python -m pytest {posargs}

setenv=
    PYCURL_SSL_LIBRARY=openssl

[testenv:flake8]
deps = flake8
commands = python -m flake8 pyrpkg/ tests/

[testenv:flake8python2]
deps = flake8
commands = python -m flake8 pyrpkg/ tests/


[testenv:doc]
basepython = python3
skip_install = True
deps =
    {[testenv]deps}
    Sphinx
    sphinx-rtd-theme
changedir = {toxinidir}/doc
commands = make html
