# AUTOGENERATED! DO NOT EDIT! File to edit: 01_train.ipynb (unless otherwise specified).

__all__ = ['train', 'export_learner']

# Cell
from fastai.collab import *
from fastai.tabular.all import *

# Cell
def train(dataframe, item_name, lr=5e-3, cycles=1):
    dls = CollabDataLoaders.from_df(dataframe, item_name=item_name, bs=64)
    learn = collab_learner(dls, n_factors=50, y_range=(0,1.5))
    learn.fit_one_cycle(cycles, lr)
    return learn

# Cell
def export_learner(learn, path, fname):
    learn.path = path
    learn.export(fname=fname)