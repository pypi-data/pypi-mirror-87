webpackJsonp([1],{"7zck":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("/5sW"),o=s("3EgV"),n=s.n(o),i=(s("7zck"),s("Dd8w")),a=s.n(i),c=s("NYxO"),l={name:"ProcessChip",computed:a()({},Object(c.c)(["nbRunningProcesses","nbStoppedProcesses"]))},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-tooltip",{attrs:{bottom:""}},[s("v-btn",{attrs:{slot:"activator",flat:"",router:"",to:"/view/process"},slot:"activator"},[s("v-icon",{staticClass:"mr-2"},[e._v("settings")]),e._v(" "),s("div",[s("v-icon",{attrs:{small:""}},[e._v("thumb_up")]),e._v("\n    "+e._s(e.nbRunningProcesses)+"\n    "),s("v-icon",{staticClass:"ml-1",attrs:{small:""}},[e._v("thumb_down")]),e._v("\n    "+e._s(e.nbStoppedProcesses)+"\n  ")],1)],1),e._v(" "),s("span",[e._v("Processes")])],1)},staticRenderFns:[]},v=s("VU/8")(l,u,!1,null,null,null).exports,p={name:"SupervisorChip",computed:a()({},Object(c.c)(["nbRunningSupervisors","nbStoppedSupervisors"]))},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-tooltip",{attrs:{bottom:""}},[s("v-btn",{attrs:{slot:"activator",flat:"",router:"",to:"/view/supervisor"},slot:"activator"},[s("v-icon",{staticClass:"mr-2"},[e._v("visibility")]),e._v(" "),s("div",[s("v-icon",{attrs:{small:""}},[e._v("thumb_up")]),e._v("\n    "+e._s(e.nbRunningSupervisors)+"\n    "),s("v-icon",{staticClass:"ml-1",attrs:{small:""}},[e._v("thumb_down")]),e._v("\n    "+e._s(e.nbStoppedSupervisors)+"\n  ")],1)],1),e._v(" "),s("span",[e._v("Supervisors")])],1)},staticRenderFns:[]},h=s("VU/8")(p,d,!1,null,null,null).exports,m={computed:a()({},Object(c.c)(["nbGroups"]))},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-tooltip",{attrs:{bottom:""}},[t("v-btn",{attrs:{slot:"activator",flat:"",router:"",to:"/view/group"},slot:"activator"},[t("v-icon",{staticClass:"mr-2"},[this._v("group_work")]),this._v("\n    "+this._s(this.nbGroups)+"\n  ")],1),this._v(" "),t("span",[this._v("Groups")])],1)},staticRenderFns:[]},_=s("VU/8")(m,f,!1,null,null,null).exports,g={name:"ActionBar",computed:{selectedProcesses:function(){return this.$store.state.selectedProcesses}},methods:a()({},Object(c.b)(["selectAll","clearSelected","restartSelected","stopSelected"]))},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-speed-dial",{attrs:{"open-on-hover":"",transition:"scale-transition",direction:"bottom"}},[s("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[s("v-icon",[e._v("more_vert")])],1),e._v(" "),s("v-tooltip",{attrs:{left:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",fab:"",small:"",dark:"",color:"green darken-2"},on:{click:function(t){return e.restartSelected()}},slot:"activator"},[s("v-icon",[e._v("autorenew")])],1),e._v(" "),s("span",[e._v("(Re)start selected processes")])],1),e._v(" "),s("v-tooltip",{attrs:{left:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",fab:"",small:"",dark:"",color:"red darken-2"},on:{click:function(t){return e.stopSelected()}},slot:"activator"},[s("v-icon",[e._v("stop")])],1),e._v(" "),s("span",[e._v("Stop selected processes")])],1),e._v(" "),s("v-tooltip",{attrs:{left:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",fab:"",small:"",dark:"",color:"blue darken-1"},on:{click:function(t){return e.clearSelected()}},slot:"activator"},[s("v-icon",[e._v("clear_all")])],1),e._v(" "),s("span",[e._v("Clear selection")])],1),e._v(" "),s("v-tooltip",{attrs:{left:""}},[s("v-btn",{attrs:{slot:"activator",fab:"",small:"",dark:"",color:"blue darken-1"},on:{click:function(t){return e.selectAll()}},slot:"activator"},[s("v-icon",[e._v("select_all")])],1),e._v(" "),s("span",[e._v("Select all")])],1)],1)},staticRenderFns:[]},w={name:"ToolBar",components:{ActionBar:s("VU/8")(g,b,!1,null,null,null).exports,ProcessChip:v,SupervisorChip:h,GroupChip:_},computed:a()({},Object(c.c)(["name"]),{isAuthenticated:function(){return this.$store.state.isAuthenticated},useAuthentication:function(){return this.$store.state.useAuthentication},search:{get:function(){return this.$store.state.search},set:function(e){this.$store.commit("updateSearch",e)}}}),methods:{logout:function(){var e=this;this.$store.dispatch("logout").then(function(){e.$router.push({name:"Login"})})}}},P={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-toolbar",{staticClass:"primary",attrs:{fixed:"",dark:"",app:""}},[s("v-menu",{directives:[{name:"show",rawName:"v-show",value:e.isAuthenticated&&e.useAuthentication,expression:"isAuthenticated && useAuthentication"}],attrs:{"offset-y":"","nudge-bottom":"15"}},[s("template",{slot:"activator"},[s("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[s("v-icon",[e._v("menu")])],1)],1),e._v(" "),s("v-list",[s("v-list-tile",{on:{click:e.logout}},[s("v-list-tile-title",[e._v("Logout")])],1)],1)],2),e._v(" "),s("v-toolbar-title",[s("router-link",{staticStyle:{cursor:"pointer"},attrs:{to:"/",tag:"span"}},[e._v(e._s(e.name))])],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.isAuthenticated||!e.useAuthentication,expression:"isAuthenticated || !useAuthentication"}],staticClass:"no-padding",attrs:{"append-icon":"search",clearable:"","single-line":"","hide-details":"",placeholder:"Filter...",color:"grey lighten-1"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),s("ActionBar",{directives:[{name:"show",rawName:"v-show",value:e.isAuthenticated||!e.useAuthentication,expression:"isAuthenticated || !useAuthentication"}]}),e._v(" "),s("v-toolbar-items",{directives:[{name:"show",rawName:"v-show",value:e.isAuthenticated||!e.useAuthentication,expression:"isAuthenticated || !useAuthentication"}]},[s("ProcessChip",{staticClass:"hidden-sm-and-down"}),e._v(" "),s("SupervisorChip",{staticClass:"hidden-sm-and-down"}),e._v(" "),s("GroupChip",{staticClass:"hidden-sm-and-down"})],1)],1)},staticRenderFns:[]};var x=s("VU/8")(w,P,!1,function(e){s("zDnr")},"data-v-f3b5b706",null).exports,S={STOPPED:"red",STARTING:"blue",RUNNING:"green",BACKOFF:"orange",STOPPING:"blue",EXITED:"red",FATAL:"purple",UNKNOWN:"grey"},k={DEBUG:"grey darken-2",INFO:"grey darken-3",WARNING:"orange",ERROR:"error"},y=function(e,t){var s=new FormData;return s.append("supervisor",e),fetch("/api/supervisor/"+t,{method:"POST",body:s})},$=function(e,t){var s=new FormData;s.append("uid",e),fetch("/api/process/"+t,{method:"POST",body:s})},C=function(e){var t=new EventSource("/api/stream");return t.onmessage=function(t){var s=JSON.parse(t.data);e(s)},t.onerror=function(){e("error")},t.onclose=function(){e("close")},t},A=function(e,t){if(0===e)return"0 b";var s=t||2,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(s))+" "+["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"][r]},N={name:"Multivisor",supervisors:{}},R={name:"NotificationBar",data:function(){return{visible:!1,color:"info"}},watch:{lastNotification:function(e){this.visible=!0,this.color=k[e.level]}},computed:{lastNotification:function(){var e=this.$store.state.notifications.length;return e?this.$store.state.notifications[e-1]:{message:""}}}},E={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("v-snackbar",{attrs:{timeout:5e3,bottom:"",right:"",color:e.color},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e._v("\n  "+e._s(e.lastNotification.message)+"\n")])},staticRenderFns:[]},L=s("VU/8")(R,E,!1,null,null,null).exports,D={render:function(){var e=this.$createElement;return(this._self._c||e)("v-alert",{attrs:{value:this.error,type:"error",transition:"scale-transition"}},[this._v(this._s(this.error))])},staticRenderFns:[]},U=s("VU/8")({name:"AlertBar",computed:{error:function(){return this.$store.state.error}}},D,!1,null,null,null).exports,G={name:"LogSheet",data:function(){return{text:"",size:0,maximize:!1,autoScroll:!0,eventSource:null}},watch:{visible:function(){this.viewLog()}},computed:{log:function(){return this.$store.state.log},visible:{get:function(){return this.$store.state.log.visible},set:function(e){this.$store.commit("setLogVisible",e)}},title:function(){return this.log.visible?("out"===this.log.stream?"O-log of ":"E-log of ")+"\n      "+this.log.process.name+" on "+this.log.process.supervisor:""},windowSize:function(){var e=window.innerHeight;return"height: "+(this.maximize?e-80:Math.min(e/3,300))+"px;"},sizeStr:function(){return A(this.size)},localSizeStr:function(){return A(this.text.length)},active:function(){return this.eventSource&&this.eventSource.readyState<2}},methods:{appendLogMessage:function(e){if(this.size=e.size,e.message&&(this.text+=e.message,this.text.length>1e7&&(this.text=this.text.substr(-9e6))),this.autoScroll){var t=document.getElementById("logContent");setTimeout(function(){t.scrollTop=t.scrollHeight},100)}},viewLog:function(){var e=this,t=this.log;if(null!==this.eventSource&&(this.text="",this.size=0,this.eventSource.close()),t.visible){var s=new EventSource("/api/process/log/"+t.stream+"/tail/"+t.process.uid);s.onmessage=function(t){var s=JSON.parse(t.data);e.appendLogMessage(s)},s.onopen=function(s){console.debug(t.stream+" stream opened for "+e.log.process.uid)},s.onclose=function(t){e.eventSource=null},s.onerror=function(t){e.eventSource.close(),e.eventSource=null},this.eventSource=s}}}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-bottom-sheet",{model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[s("v-toolbar",{attrs:{dense:"",height:"32px",color:"err"===e.log.stream?"orange":"blue"}},[s("h5",[e._v(e._s(e.title))]),e._v(" "),s("v-spacer"),e._v(" "),s("v-tooltip",{attrs:{bottom:""}},[s("v-switch",{staticStyle:{height:"32px"},attrs:{slot:"activator",color:"indigo"},slot:"activator",model:{value:e.autoScroll,callback:function(t){e.autoScroll=t},expression:"autoScroll"}}),e._v(" "),s("span",[e._v("auto-scroll ("+e._s(e.autoScroll?"On":"Off")+")")])],1),e._v(" "),s("v-tooltip",{attrs:{bottom:""}},[s("v-chip",{attrs:{slot:"activator",color:"indigo white--text",dark:""},slot:"activator"},[e._v("\n        "+e._s(e.localSizeStr)+"\n        "),s("v-btn",{staticClass:"ml-0",attrs:{icon:"",small:"",left:""},on:{click:function(t){e.text=""}}},[s("v-icon",[e._v("delete")])],1)],1),e._v(" "),s("span",[e._v("Web console log size")])],1),e._v(" "),s("v-tooltip",{attrs:{bottom:""}},[s("v-chip",{staticClass:"indigo white--text",attrs:{slot:"activator",dark:""},slot:"activator"},[e._v("\n        "+e._s(e.sizeStr)+"\n      ")]),e._v(" "),s("span",[e._v("Remote log size")])],1),e._v(" "),s("v-btn",{staticClass:"mr-2",attrs:{icon:"",dark:"",small:""},on:{click:function(t){e.maximize=!e.maximize}}},[e.maximize?s("v-icon",[e._v("expand_more")]):s("v-icon",[e._v("expand_less")])],1)],1),e._v(" "),s("v-progress-linear",{staticClass:"my-0",attrs:{indeterminate:e.active,height:"1","background-color":"white",color:"deep-purple"}}),e._v(" "),s("v-card",[s("v-card-text",{staticClass:"scroll-y black white--text px-2 py-0",style:e.windowSize,attrs:{id:"logContent"}},[s("pre",{staticClass:"logConsole "},[e._v("        "+e._s(e.text)+"\n      ")])])],1)],1)},staticRenderFns:[]};var M=s("VU/8")(G,F,!1,function(e){s("vvh5")},"data-v-2ae5b902",null).exports,O={name:"ProcessDetails",data:function(){return{items:[{id:"name",label:"Name",color:"red"},{value:this.startTime,label:"Started at (last)",color:"red darken-2"},{id:"description",label:"Description",color:"orange"},{id:"host",label:"Host",color:"green"},{id:"supervisor",label:"Supervisor",color:"green darken-2"},{id:"pid",label:"PID",color:"blue"},{id:"exitstatus",label:"Exit status (last)",color:"blue darken-2"},{id:"logfile",label:"Output log file",color:"purple"},{id:"stderr_logfile",label:"Error log file",color:"purple darken-2"}]}},computed:{process:function(){return this.$store.state.processDetails.process},visible:{get:function(){return this.$store.state.processDetails.visible},set:function(e){this.$store.commit("setProcessDetailsVisible",e)}},lastUpdate:function(){return e=this.process.now,t={prefix:"",suffix:" ago",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years"},s=function(e,s){return t[e]&&t[e].replace(/%d/i,Math.abs(Math.round(s)))},r=new Date(1e3*e),o=.001*((new Date).getTime()-r)>>0,c=(a=(i=(n=o/60)/60)/24)/365,t.prefix+(o<45&&s("seconds",o)||o<90&&s("minute",1)||n<45&&s("minutes",n)||n<90&&s("hour",1)||i<24&&s("hours",i)||i<42&&s("day",1)||a<30&&s("days",a)||a<45&&s("month",1)||a<365&&s("months",a/30)||c<1.5&&s("year",1)||s("years",c))+t.suffix;var e,t,s,r,o,n,i,a,c}},methods:{startTime:function(){return Date(this.process.start)},showItem:function(e){return"value"in e||""!==this.process[e.id]},itemValue:function(e){return"id"in e?this.process[e.id]:e.value()}}},V={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-bottom-sheet",{attrs:{inset:""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[s("v-card",[s("v-card-title",[e._v("Last updated "+e._s(e.lastUpdate))]),e._v(" "),s("v-list",{attrs:{dense:""}},[e._l(e.items,function(t,r){return[e.showItem(t)?s("v-list-tile",{key:t.id,attrs:{avatar:""}},[s("v-list-tile-avatar",{attrs:{color:t.color}},[s("span",{staticClass:"white--text headline"},[e._v(e._s(t.label[0]))])]),e._v(" "),s("v-list-tile-content",[s("v-list-tile-title",[e._v(e._s(e.itemValue(t)))]),e._v(" "),s("v-list-tile-sub-title",[e._v(e._s(t.label))])],1)],1):e._e(),e._v(" "),r<e.items.length-2?s("v-divider",{attrs:{inset:""}}):e._e()]})],2)],1)],1)},staticRenderFns:[]},T=s("VU/8")(O,V,!1,null,null,null).exports,z={components:{ToolBar:x,LogSheet:M,ProcessDetails:T,NotificationBar:L,AlertBar:U}},I={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",[t("ToolBar"),this._v(" "),t("v-content",[t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("AlertBar"),this._v(" "),t("router-view")],1)],1),this._v(" "),t("NotificationBar"),this._v(" "),t("LogSheet"),this._v(" "),t("ProcessDetails")],1)},staticRenderFns:[]},j=s("VU/8")(z,I,!1,null,null,null).exports,B=s("gRE1"),H=s.n(B),q=s("Xxa5"),W=s.n(q),K=s("exGp"),J=s.n(K),X=s("Gu7T"),Y=s.n(X),Z=s("lHA8"),Q=s.n(Z);r.default.use(c.a);var ee=new c.a.Store({state:{multivisor:N,error:"",notifications:[],selectedProcesses:[],search:"",log:{process:null,visible:!1,stream:"out"},processDetails:{process:{name:"",uid:"",pid:0,description:"",exitstatus:0,logfile:null,stderr_logfile:null,start:0,now:0},visible:!1},isAuthenticated:void 0,useAuthentication:void 0},mutations:{updateMultivisor:function(e,t){e.multivisor=t},updateProcess:function(e,t){e.multivisor.supervisors[t.supervisor].processes[t.uid]=t},updateSupervisor:function(e,t){e.multivisor.supervisors[t.name]=t},newNotification:function(e,t){e.notifications.push(t)},setLogVisible:function(e,t){e.log.visible=t},setLog:function(e,t){e.log=t},setSelectedProcesses:function(e,t){e.selectedProcesses=t},addSelectedProcesses:function(e,t){var s=new Q.a([].concat(Y()(e.selectedProcesses),Y()(t)));e.selectedProcesses=[].concat(Y()(s))},removeSelectedProcesses:function(e,t){var s=new Q.a(t);e.selectedProcesses=e.selectedProcesses.filter(function(e){return!s.has(e)})},updateSearch:function(e,t){e.search=t},setProcessDetailsVisible:function(e,t){e.processDetails.visible=t},setProcessDetails:function(e,t){e.processDetails=t},setIsAuthenticated:function(e,t){e.isAuthenticated=t},setUseAuthentication:function(e,t){e.useAuthentication=t},logout:function(e){e.isAuthenticated=!1},setError:function(e,t){e.error=t},setMultivisorError:function(e){e.error="Couldn't connect to multivisor server, make sure it is running"}},actions:{init:function(e){var t=this,s=e.commit;return J()(W.a.mark(function e(){var r,o;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/data");case 2:if(401!==(r=e.sent).status){e.next=7;break}return e.abrupt("return");case 7:if(504!==r.status){e.next=11;break}s("setMultivisorError"),e.next=15;break;case 11:return e.next=13,r.json();case 13:o=e.sent,s("updateMultivisor",o);case 15:C(function(e){"error"===e||"close"===e?(s("setMultivisorError"),s("updateMultivisor",N)):"process_changed"===e.event?s("updateProcess",e.payload):"supervisor_changed"===e.event?s("updateSupervisor",e.payload):"notification"===e.event&&s("newNotification",e.payload)});case 17:case"end":return e.stop()}},e,t)}))()},restartProcesses:function(e,t){$(t,"restart")},stopProcesses:function(e,t){$(t,"stop")},selectAll:function(){this.commit("setSelectedProcesses",[].concat(Y()(this.getters.filteredProcessUIDs)))},clearSelected:function(){this.commit("setSelectedProcesses",[])},restartSelected:function(){var e=this;this.dispatch("restartProcesses",this.state.selectedProcesses).then(function(){e.dispatch("clearSelected")})},stopSelected:function(){var e=this;this.dispatch("stopProcesses",this.state.selectedProcesses).then(function(){e.dispatch("clearSelected")})},updateSupervisor:function(e,t){y(t,"update")},restartSupervisor:function(e,t){y(t,"restart")},logout:function(){this.commit("logout"),fetch("/api/logout",{method:"POST"})}},getters:{name:function(e){return e.multivisor.name},supervisors:function(e){return H()(e.multivisor.supervisors)},processes:function(e,t){return t.supervisors.reduce(function(e,t){return e.push.apply(e,Y()(H()(t.processes))),e},[])},groupMap:function(e,t){return t.processes.reduce(function(e,t){return t.group in e&&e[t.group].processes.push(t)||(e[t.group]={name:t.group,processes:[t]}),e},{})},groups:function(e,t){return H()(t.groupMap)},supervisor:function(e){return function(t){return e.multivisor.supervisors[t]}},process:function(e,t){return function(e){return t.processes.find(function(t){return t.uid===e})}},group:function(e,t){return function(e){return t.groupMap[e]}},filteredProcessUIDs:function(e,t){if(!e.search)return new Q.a(t.processes.map(function(e){return e.uid}));var s=e.search.toLowerCase();return t.processes.reduce(function(e,t){return-1===t.uid.toLowerCase().indexOf(s)&&-1===t.statename.toLowerCase().indexOf(s)||e.add(t.uid),e},new Q.a)},filteredGroupMap:function(e,t){if(!e.search)return t.groups;var s=t.filteredProcessUIDs;return t.processes.reduce(function(e,t){return s.has(t.uid)&&(t.group in e&&e[t.group].processes.push(t)||(e[t.group]={name:t.group,processes:[t]})),e},{})},filteredGroups:function(e,t){return H()(t.filteredGroupMap)},totalNbProcesses:function(e,t){return t.processes.length},nbRunningProcesses:function(e,t){return t.processes.reduce(function(e,t){return t.running?e+1:e},0)},nbStoppedProcesses:function(e,t){return t.totalNbProcesses-t.nbRunningProcesses},totalNbSupervisors:function(e,t){return t.supervisors.length},nbRunningSupervisors:function(e,t){return t.supervisors.reduce(function(e,t){return t.running?e+1:e},0)},nbStoppedSupervisors:function(e,t){return t.totalNbSupervisors-t.nbRunningSupervisors},nbGroups:function(e,t){return t.groups.length}}}),te=s("/ocq"),se={name:"ProcessState",props:{state:{default:"UNKNOWN"},small:{default:!1}},data:function(){return{stateColorMap:S}}},re={render:function(){var e=this.$createElement;return(this._self._c||e)("v-chip",{attrs:{disabled:"",label:"",color:this.stateColorMap[this.state],"text-color":"white",small:this.small}},[this._v("\n        "+this._s(this.state)+"\n")])},staticRenderFns:[]},oe={name:"ProcessTitle",props:["process"],components:{ProcessState:s("VU/8")(se,re,!1,null,null,null).exports},computed:{selectedProcesses:{get:function(){return this.$store.state.selectedProcesses},set:function(e){this.$store.commit("setSelectedProcesses",e)}}},methods:{restartProcess:function(e){this.$store.dispatch("restartProcesses",[e.uid])},stopProcess:function(e){this.$store.dispatch("stopProcesses",[e.uid])},viewLog:function(e,t){this.$store.commit("setLog",{process:e,stream:t,visible:!0})},viewDetails:function(e){this.$store.commit("setProcessDetails",{process:e,visible:!0})}}},ne={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-list-tile",[s("v-list-tile-action",[s("v-checkbox",{attrs:{"hide-details":"",value:e.process.uid},model:{value:e.selectedProcesses,callback:function(t){e.selectedProcesses=t},expression:"selectedProcesses"}})],1),e._v(" "),s("v-list-tile-content",[s("v-list-tile-title",[e._v(e._s(e.process.name))])],1),e._v(" "),s("v-list-tile-action",[s("v-flex",{attrs:{"justify-end":""}},[s("ProcessState",{attrs:{state:e.process.statename}}),e._v(" "),s("v-btn",{attrs:{icon:""},on:{click:function(t){return e.restartProcess(e.process)}}},[s("v-icon",{attrs:{color:"green"}},[e.process.running?[e._v("autorenew")]:[e._v("play_arrow")]],2)],1),e._v(" "),s("v-btn",{attrs:{icon:"",disabled:!e.process.running},on:{click:function(t){return e.stopProcess(e.process)}}},[s("v-icon",{attrs:{color:"red"}},[e._v("stop")])],1),e._v(" "),s("v-menu",{attrs:{"open-on-hover":""}},[s("v-btn",{attrs:{slot:"activator",icon:"",small:"",color:"blue--text"},slot:"activator"},[s("v-icon",[e._v("more_vert")])],1),e._v(" "),s("div",{staticClass:"grey lighten-3"},[s("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.viewDetails(e.process)}}},[s("v-icon",{attrs:{color:"blue"}},[e._v("info")])],1),e._v(" "),e.process.logfile?s("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.viewLog(e.process,"out")}}},[s("v-icon",{attrs:{color:"blue"}},[e._v("description")])],1):e._e(),e._v(" "),e.process.stderr_logfile?s("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.viewLog(e.process,"err")}}},[s("v-icon",{attrs:{color:"orange"}},[e._v("description")])],1):e._e()],1)],1)],1)],1)],1)},staticRenderFns:[]},ie=s("VU/8")(oe,ne,!1,null,null,null).exports,ae={name:"GroupList",props:["group"],components:{ProcessTile:ie}},ce={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("v-list",{attrs:{dense:""}},[this._l(this.group.processes,function(e){return[t("ProcessTile",{attrs:{process:e}})]})],2)],1)},staticRenderFns:[]},le={name:"GroupCard",props:["item"],components:{GroupList:s("VU/8")(ae,ce,!1,null,null,null).exports},computed:{group:function(){return this.item.item},selectedProcesses:function(){var e=this;return this.$store.state.selectedProcesses.reduce(function(t,s){return s.split(":",2)[1]===e.group.name&&t.push(s),t},[])}},methods:{restartSelected:function(){this.$store.dispatch("restartProcesses",this.selectedProcesses),this.clearSelected()},stopSelected:function(){this.$store.dispatch("stopProcesses",this.selectedProcesses),this.clearSelected()},selectAll:function(){var e=this.group.processes.reduce(function(e,t){return e.push(t.uid),e},[]);this.$store.commit("addSelectedProcesses",e)},clearSelected:function(){this.$store.commit("removeSelectedProcesses",this.selectedProcesses)}}},ue={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",[s("v-toolbar",{attrs:{dense:"",color:"purple darken-2",dark:""}},[s("v-toolbar-title",[e._v(e._s(e.group.name))]),e._v(" "),s("v-spacer"),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.restartSelected()}},slot:"activator"},[s("v-icon",[e._v("autorenew")])],1),e._v(" "),s("span",[e._v("(Re)start selected processes")])],1),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.stopSelected()}},slot:"activator"},[s("v-icon",[e._v("stop")])],1),e._v(" "),s("span",[e._v("Stop selected processes")])],1),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.clearSelected()}},slot:"activator"},[s("v-icon",[e._v("clear_all")])],1),e._v(" "),s("span",[e._v("Clear selection")])],1),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length<e.group.processes.length,expression:"selectedProcesses.length < group.processes.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.selectAll()}},slot:"activator"},[s("v-icon",[e._v("done_all")])],1),e._v(" "),s("span",[e._v("Select all")])],1)],1),e._v(" "),s("GroupList",{attrs:{group:e.group}})],1)},staticRenderFns:[]},ve={name:"GroupPage",components:{GroupCard:s("VU/8")(le,ue,!1,null,null,null).exports},computed:a()({},Object(c.c)({groups:"filteredGroups"}))},pe={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-data-iterator",{attrs:{"content-tag":"v-layout",row:"",wrap:"","hide-actions":"","item-key":"name",items:this.groups,"no-results-text":"Sorry, no matching processes found","no-data-text":"Sorry, there are no processes currently being monitored"},scopedSlots:this._u([{key:"item",fn:function(e){return t("v-flex",{attrs:{xs12:"",sm12:"",md6:"",lg4:"",xl3:""}},[t("GroupCard",{attrs:{item:e}})],1)}}])})],1)},staticRenderFns:[]},de=s("VU/8")(ve,pe,!1,null,null,null).exports,he={name:"ProcessRow",props:["row","show-supervisor","show-group"],data:function(){return{stateColorMap:S}},computed:{process:function(){return this.row.item},selectedProcesses:{get:function(){return this.$store.state.selectedProcesses},set:function(e){this.$store.commit("setSelectedProcesses",e)}}},methods:{restartProcess:function(e){this.$store.dispatch("restartProcesses",[e.uid])},stopProcess:function(e){this.$store.dispatch("stopProcesses",[e.uid])},viewLog:function(e,t){this.$store.commit("setLog",{process:e,stream:t,visible:!0})},viewDetails:function(e){this.$store.commit("setProcessDetails",{process:e,visible:!0})}}},me={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",[s("td",{staticClass:"px-0",staticStyle:{height:"30px"}},[s("v-checkbox",{attrs:{primary:"","hide-details":"",value:e.process.uid},model:{value:e.selectedProcesses,callback:function(t){e.selectedProcesses=t},expression:"selectedProcesses"}})],1),e._v(" "),s("td",{staticClass:"px-0",staticStyle:{height:"30px"}},[e._v("\n    "+e._s(e.process.name)+"\n  ")]),e._v(" "),e.showGroup?s("td",{staticClass:"hidden-xs-only px-0",staticStyle:{height:"30px"}},[e._v("\n      "+e._s(e.row.item.group)+"\n  ")]):e._e(),e._v(" "),e.showSupervisor?s("td",{staticClass:"hidden-xs-only px-0",staticStyle:{height:"30px"}},[e._v("\n    "+e._s(e.process.supervisor)+"\n  ")]):e._e(),e._v(" "),s("td",{staticClass:"px-0",staticStyle:{height:"30px"}},[s("v-chip",{attrs:{disabled:"",label:"",color:e.stateColorMap[e.process.statename],"text-color":"white",small:""}},[e._v("\n            "+e._s(e.process.statename)+"\n    ")])],1),e._v(" "),s("td",{staticClass:"layout px-0",staticStyle:{height:"30px"}},[s("v-btn",{staticClass:"mx-0 my-1",attrs:{icon:"",small:""},on:{click:function(t){return e.restartProcess(e.process)}}},[s("v-icon",{attrs:{color:"green"}},[e.row.item.running?[e._v("autorenew")]:[e._v("play_arrow")]],2)],1),e._v(" "),s("v-btn",{staticClass:"mx-0 my-1",attrs:{icon:"",small:"",disabled:!e.row.item.running},on:{click:function(t){return e.stopProcess(e.process)}}},[s("v-icon",{attrs:{color:"red"}},[e._v("stop")])],1),e._v(" "),s("v-menu",{attrs:{"open-on-hover":""}},[s("v-btn",{attrs:{slot:"activator",icon:"",small:"",color:"blue--text"},slot:"activator"},[s("v-icon",[e._v("more_vert")])],1),e._v(" "),s("div",{staticClass:"grey lighten-3"},[s("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.viewDetails(e.process)}}},[s("v-icon",{attrs:{color:"blue"}},[e._v("info")])],1),e._v(" "),e.process.logfile?s("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.viewLog(e.process,"out")}}},[s("v-icon",{attrs:{color:"blue"}},[e._v("description")])],1):e._e(),e._v(" "),e.process.stderr_logfile?s("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.viewLog(e.process,"err")}}},[s("v-icon",{attrs:{color:"orange"}},[e._v("description")])],1):e._e()],1)],1)],1)])},staticRenderFns:[]},fe={name:"ProcessPage",props:{processes:{default:null},showGroup:{default:!0},showSupervisor:{default:!0}},components:{ProcessRow:s("VU/8")(he,me,!1,null,null,null).exports,ProcessDetails:T},computed:{headers:function(){var e=[{align:"left",sortable:!0,text:"Name",value:"name",tooltip:"process name"}];return this.showGroup&&e.push({align:"left",sortable:!0,text:"Group",value:"group",tooltip:"process group",class:"hidden-xs-only"}),this.showSupervisor&&e.push({align:"left",sortable:!0,text:"Supervisor",value:"supervisor",tooltip:"supervisor controlling process",class:"hidden-xs-only"}),e.push({align:"left",sortable:!0,text:"State",value:"statename",tooltip:"process state"}),e.push({align:"left",sortable:!1,text:"Actions",value:"",tooltip:"(re)start/stop/view log"}),e},search:function(){return this.$store.state.search},selectedProcesses:{get:function(){return this.$store.state.selectedProcesses},set:function(e){this.$store.commit("setSelectedProcesses",e)}},procs:function(){return this.processes||this.$store.getters.processes}}},_e={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{"justify-center":""}},[s("v-data-table",{staticClass:"elevation-4",attrs:{headers:e.headers,items:e.procs,search:e.search,"hide-actions":"","select-all":"","no-results-text":"Sorry, no matching processes found","no-data-text":"Sorry, there are no processes currently being monitored","must-sort":"","item-key":"uid"},scopedSlots:e._u([{key:"headerCell",fn:function(t){return[s("v-tooltip",{attrs:{bottom:""}},[s("span",{attrs:{slot:"activator"},slot:"activator"},[e._v("\n        "+e._s(t.header.text)+"\n      ")]),e._v(" "),s("span",[e._v("\n        "+e._s(t.header.tooltip)+"\n      ")])])]}},{key:"items",fn:function(t){return[s("ProcessRow",{attrs:{row:t,"show-supervisor":e.showSupervisor,"show-group":e.showGroup}})]}}]),model:{value:e.selectedProcesses,callback:function(t){e.selectedProcesses=t},expression:"selectedProcesses"}})],1)},staticRenderFns:[]},ge=s("VU/8")(fe,_e,!1,null,null,null).exports,be={name:"SupervisorList",props:["supervisor"],components:{ProcessTile:ie}},we={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._l(e.supervisor.groups,function(t,r){return s("v-list",{key:t.name,attrs:{subheader:"",dense:""}},[r>0?s("v-divider"):e._e(),e._v(" "),s("v-subheader",{staticStyle:{height:"24px"}},[e._v("\n      "+e._s(t.name)+"\n    ")]),e._v(" "),e._l(t.processes,function(e){return[s("ProcessTile",{attrs:{process:e}})]})],2)}),1)},staticRenderFns:[]},Pe={name:"SupervisorCard",props:["item"],components:{SupervisorList:s("VU/8")(be,we,!1,null,null,null).exports},computed:{supervisor:function(){return this.item.item},inactive:function(){return!this.supervisor.running},toolbarColor:function(){return this.inactive?"grey lighten-1":"indigo"},selectedProcesses:function(){var e=this;return this.$store.state.selectedProcesses.reduce(function(t,s){return s.split(":",1)[0]===e.supervisor.name&&t.push(s),t},[])}},methods:{updateSupervisor:function(){this.$store.dispatch("updateSupervisor",this.supervisor.name)},restartSupervisor:function(){this.$store.dispatch("restartSupervisor",this.supervisor.name)},restartSelectedProcesses:function(){this.$store.dispatch("restartProcesses",this.selectedProcesses),this.clearSelectedProcesses()},stopSelectedProcesses:function(){this.$store.dispatch("stopProcesses",this.selectedProcesses),this.clearSelectedProcesses()},selectAllProcesses:function(){var e=[];for(var t in this.supervisor.processes)e.push(this.supervisor.processes[t].uid);this.$store.commit("addSelectedProcesses",e)},clearSelectedProcesses:function(){this.$store.commit("removeSelectedProcesses",this.selectedProcesses)}}},xe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",[s("v-toolbar",{attrs:{dense:"",color:e.toolbarColor,dark:""}},[s("v-toolbar-title",[e._v(e._s(e.supervisor.name)+" "),e.inactive?s("span",[e._v("(offline)")]):e._e()]),e._v(" "),s("v-spacer"),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.restartSelectedProcesses()}},slot:"activator"},[s("v-icon",[e._v("autorenew")])],1),e._v(" "),s("span",[e._v("(Re)start selected processes")])],1),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.stopSelectedProcesses()}},slot:"activator"},[s("v-icon",[e._v("stop")])],1),e._v(" "),s("span",[e._v("Stop selected processes")])],1),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length,expression:"selectedProcesses.length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.clearSelectedProcesses()}},slot:"activator"},[s("v-icon",[e._v("clear_all")])],1),e._v(" "),s("span",[e._v("Clear selection")])],1),e._v(" "),s("v-tooltip",{attrs:{top:""}},[s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selectedProcesses.length<Object.keys(e.supervisor.processes).length,expression:"selectedProcesses.length < Object.keys(supervisor.processes).length"}],attrs:{slot:"activator",icon:"",small:""},on:{click:function(t){return e.selectAllProcesses()}},slot:"activator"},[s("v-icon",[e._v("done_all")])],1),e._v(" "),s("span",[e._v("Select all")])],1),e._v(" "),e.inactive?e._e():s("v-menu",{attrs:{bottom:"",left:""}},[s("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[s("v-icon",[e._v("more_vert")])],1),e._v(" "),s("v-list",[s("v-list-tile",{on:{click:function(t){return e.updateSupervisor()}}},[s("v-list-tile-title",[e._v("Update")])],1),e._v(" "),s("v-list-tile",{on:{click:function(t){return e.restartSupervisor()}}},[s("v-list-tile-title",[e._v("Restart")])],1)],1)],1)],1),e._v(" "),s("SupervisorList",{attrs:{supervisor:e.supervisor}})],1)},staticRenderFns:[]},Se={name:"SupervisorPage",components:{SupervisorCard:s("VU/8")(Pe,xe,!1,null,null,null).exports},computed:{supervisorsGroups:function(){var e=this.$store.getters.supervisors,t=this.$store.getters.filteredProcessUIDs;return e.reduce(function(e,s){var r=H()(s.processes),o=H()(r.reduce(function(e,s){return t.has(s.uid)&&(s.group in e&&e[s.group].processes.push(s)||(e[s.group]={name:s.group,processes:[s]})),e},{}));return e.push(a()({},s,{groups:o})),e},[])}}},ke={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-data-iterator",{attrs:{"content-tag":"v-layout",row:"",wrap:"","hide-actions":"","item-key":"name",items:this.supervisorsGroups,"no-results-text":"Sorry, no matching processes found","no-data-text":"Sorry, there are no processes currently being monitored"},scopedSlots:this._u([{key:"item",fn:function(e){return t("v-flex",{attrs:{xs12:"",sm12:"",md6:"",lg4:""}},[t("SupervisorCard",{attrs:{item:e}})],1)}}])})],1)},staticRenderFns:[]},ye=s("VU/8")(Se,ke,!1,null,null,null).exports,$e={name:"LoginPage",data:function(){return{valid:!1,username:"",password:"",rules:{required:function(e){return!!e||"This field is required"}},errorMessages:{username:[],password:[]}}},methods:{submit:function(){var e=this;if(this.$refs.form.validate()){var t=new FormData;t.append("username",this.username),t.append("password",this.password),fetch("/api/login",{method:"POST",body:t}).then(function(t){200===t.status?(e.$store.commit("setIsAuthenticated",!0),e.$store.dispatch("init"),e.$router.push({name:"Home"})):t.json().then(function(t){e.errorMessages=t.errors})})}}}},Ce={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{fluid:"","grid-list-md":""}},[s("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-layout",{attrs:{"align-center":"","justify-center":""}},[s("v-flex",{attrs:{xs12:"",sm6:"",md5:"",lg4:"",xl3:""}},[s("v-card",{staticClass:"elevation-12"},[s("v-toolbar",{attrs:{dark:"",color:"primary"}},[s("v-toolbar-title",[e._v("Log in")])],1),e._v(" "),s("v-card-text",[s("v-form",{ref:"form",nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{attrs:{autofocus:"","prepend-icon":"person",name:"username",label:"Username",type:"text",rules:[e.rules.required],"error-messages":e.errorMessages.username},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:"Password",type:"password",rules:[e.rules.required],"error-messages":e.errorMessages.password},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),s("v-card-actions",{attrs:{align:"center"}},[s("v-layout",{attrs:{"justify-center":""}},[s("v-btn",{attrs:{color:"primary",bottom:""},on:{click:e.submit}},[e._v("Log in")])],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},Ae=s("VU/8")($e,Ce,!1,null,null,null).exports;r.default.use(te.a);var Ne,Re={meta:{requiresAuth:!0}},Ee=new te.a({routes:[a()({path:"/",name:"Home",component:de},Re),{path:"/login",name:"Login",component:Ae},a()({path:"/view/group",name:"GroupPage",component:de},Re),a()({path:"/view/supervisor",name:"SupervisorPage",component:ye},Re),a()({path:"/view/process",name:"ProcessPage",component:ge},Re)],mode:"history"});Ee.beforeEach((Ne=J()(W.a.mark(function e(t,s,r){var o,n,i;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==ee.state.useAuthentication&&void 0!==ee.state.isAuthenticated){e.next=11;break}return e.next=3,fetch("/api/auth");case 3:if(504!==(o=e.sent).status){e.next=6;break}return e.abrupt("return",r());case 6:return e.next=8,o.json();case 8:n=e.sent,ee.commit("setUseAuthentication",n.use_authentication),ee.commit("setIsAuthenticated",n.is_authenticated);case 11:if(ee.state.useAuthentication){e.next=15;break}if("Login"!==t.name){e.next=14;break}return e.abrupt("return",r({name:"Home"}));case 14:return e.abrupt("return",r());case 15:if(i=t.matched.some(function(e){return e.meta.requiresAuth}),ee.state.isAuthenticated||!i){e.next=18;break}return e.abrupt("return",r({name:"Login"}));case 18:if("Login"!==t.name||!ee.state.isAuthenticated){e.next=20;break}return e.abrupt("return",r({name:"Home"}));case 20:return e.abrupt("return",r());case 21:case"end":return e.stop()}},e,this)})),function(e,t,s){return Ne.apply(this,arguments)}));var Le=Ee;r.default.use(n.a),r.default.config.productionTip=!1,new r.default({el:"#app",store:ee,router:Le,render:function(e){return e(j)},created:function(){this.$store.dispatch("init")}})},vvh5:function(e,t){},zDnr:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.f7a39fbaedf78cdc919b.js.map