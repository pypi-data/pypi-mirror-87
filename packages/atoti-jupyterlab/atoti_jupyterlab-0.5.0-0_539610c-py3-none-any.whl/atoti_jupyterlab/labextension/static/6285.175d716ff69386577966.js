(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[6285],{46285:(e,n,o)=>{"use strict";o.r(n),o.d(n,{default:()=>H});var r=o(39030),l=o(12370),a=o(56271),i=o.n(a),t=(o(78951),o(8336)),d=(o(2689),o(85902)),s=o(58527),u=o.n(s),m=o(56974),h=o.n(m),c=o(18149),p=o.n(c),x=o(88665),v=o.n(x),f=o(40441),y=o(94212),g=o(44652),I=o(35129),C=o(3582),w=o(92662),b=o.n(w),E=o(10208),S=o(39349),R=o(88327),N=o(95923),P=o(31312);const k=({parentTotalRowIndex:e,rowIndex:n})=>({backgroundColor:(n-e)%2==1?"#FAFAFA":"",borderRight:"1px solid #E9E9E9",borderTop:e===n&&n>0?"1px solid #E9E9E9":""}),A=e=>{var n;return(null===(n=e.axis)||void 0===n?void 0:n.id)===g.xy.rows?(({axis:e,columnIndex:n,hierarchyIndex:o,levelIndex:r,numberOfColumnsInRowHeaders:l,numberOfRowsInColumnHeaders:a,parentTotalRowIndex:i,rowIndex:t})=>{var d;if(void 0===e)return{};const s=(null==e||null===(d=e.range)||void 0===d?void 0:d.from)||0,u=(null==e?void 0:e.positions[t-s][o].captionPath[r])||"",m=null==e?void 0:e.positions[t-s-1],h=m&&m[o].captionPath[r]||"";return{backgroundColor:n===l-1&&(t-i)%2==1?"#FAFAFA":"",borderRight:n===l-1?"2px solid #E9E9E9":"",borderTop:t===i&&t>0?"1px solid #E9E9E9":"",fontWeight:n===l-1?void 0:600,...n<l-1&&""!==u&&u===h?{display:"none"}:{}}})(e):(({axis:e,columnIndex:n,hierarchyIndex:o,levelIndex:r,numberOfColumnsInRowHeaders:l,numberOfRowsInColumnHeaders:a,parentTotalRowIndex:i,rowIndex:t})=>{var d;if(void 0===e)return{};const s=(null==e||null===(d=e.range)||void 0===d?void 0:d.from)||0,u=(null==e?void 0:e.positions[n-s][o].captionPath[r])||"",m=null==e?void 0:e.positions[n-s-1],h=m&&m[o].captionPath[r]||"";return t<a-1&&""!==u&&u===h?{display:"none",fontWeight:600}:{fontWeight:600}})(e)},M=i().memo((e=>{var n,o,r,a;const i=(0,f.bb)(e),{formatMessage:d}=(0,S.useIntl)();if(null===i)return null;if(i.every((e=>"AllMember"===h()(e.captionPath)))&&0===e.rowIndex&&0===e.columnIndex)return(0,t.jsx)("div",{style:{fontSize:12,fontWeight:600,padding:"4px 4px 3px"}},d({id:"aui.total"}));const s=h()(i.filter((e=>"AllMember"!==h()(e.captionPath))));if(void 0===s)return null;const{cube:u,mapping:m}=e,c=s&&u&&"Measures"!==s.dimensionName?(0,I._y)(s,u):null,x=(null===(n=e.axis)||void 0===n?void 0:n.id)===g.xy.rows?m.rows:m.columns,v=s?x.find((e=>e.startsWith((0,E.mW)(null==s?void 0:s.dimensionName,null==s?void 0:s.hierarchyName)))):null,y=v?h()((0,E.I8)(v)):null,w=c&&y?c.levels.findIndex((({name:e})=>e===y)):-1,R=c?c.levels.length-2:-1,N=e.levelIndex>=w&&e.levelIndex<=R,P=e.isExpanded(i.slice(0,e.hierarchyIndex+1).map((({dimensionName:e,hierarchyName:n,namePath:o})=>({dimensionName:e,hierarchyName:n,namePath:o})))),k=(null===(o=h()(i.slice(0,e.hierarchyIndex+1)).captionPath)||void 0===o?void 0:o[e.levelIndex])||"",M=P?C.DownOutlined:b(),O=null===(r=e.sort)||void 0===r?void 0:r.orderMode,j=null===(a=e.sort)||void 0===a?void 0:a.tupleCoordinates,H=i.map((({dimensionName:e,hierarchyName:n,namePath:o})=>({dimensionName:e,hierarchyName:n,namePath:o}))),T=k===s.captionPath[e.levelIndex]&&O&&j&&p()(H,j),K=T&&"ASC"===O?l.od:T&&"DESC"===O?l._r:void 0,W={...(0,f.pB)(e),...A({axis:e.axis,columnIndex:e.columnIndex,hierarchyIndex:e.hierarchyIndex,levelIndex:e.levelIndex,numberOfColumnsInRowHeaders:e.numberOfColumnsInRowHeaders,numberOfRowsInColumnHeaders:e.numberOfRowsInColumnHeaders,parentTotalRowIndex:e.parentTotalRowIndex||0,rowIndex:e.rowIndex})};return(0,t.jsx)("div",{style:{overflow:"hidden",display:"flex",alignItems:"center",...W}},N&&""!==k?(0,t.jsx)(M,{onClick:()=>{e.onExpansionChanged(i.slice(0,e.hierarchyIndex+1),!P)},style:{cursor:"pointer",fontSize:10,marginRight:6}}):null,(0,t.jsx)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxWidth:`calc(100% - ${N?"16px":"0px"} - ${T?"18px":"0px"} `}},k),K&&""!==k?(0,t.jsx)(K,{onClick:e.onSortChanged,style:{cursor:"pointer",marginLeft:"auto",height:"100%"}}):(0,t.jsx)("div",{style:{height:"100%",marginLeft:6}}))})),O=(e,n)=>{if((0,r.cv)(n)!==(0,r.cv)(e))return!1;if((0,r.cv)(n)&&(0,r.cv)(e)){var o,l;const{dashboardState:r,onDashboardChange:a,...i}=e,{dashboardState:t,onDashboardChange:d,...s}=n;return v()(i,s)&&r.filters===t.filters&&(null===(o=(0,P.fx)(r,e.pageKey))||void 0===o?void 0:o.filters)===(null===(l=(0,P.fx)(t,n.pageKey))||void 0===l?void 0:l.filters)}return v()(e,n)},j=e=>{(0,r.v4)(e);const{queryResult:n,onChange:o,onSelectionChange:l,widgetState:t}=e,{mdx:s}=t.query,{serverKey:m}=t,c=(0,N.kP)(m),x=(0,a.useMemo)((()=>s&&(0,E.pO)(s)),[s]),v=(0,a.useMemo)((()=>c&&x?(0,I.sR)(c,x):void 0),[c,x]),C=(0,a.useMemo)((()=>s?(0,E.KY)(s):null),[s]),w=(0,a.useMemo)((()=>s&&(0,E.r$)(s)),[s]),b=(0,a.useCallback)(((e,n)=>{const r=h()(e);if(v&&s&&r){const{dimensionName:l,hierarchyName:a}=r,i=(0,I._y)({dimensionName:l,hierarchyName:a},v),d=r.namePath.length-1;if(d<i.levels.length-1){let r=s;r=n?(0,E.jn)(s,e,i.levels[d+1].name):(0,E.wo)(s,e);const l=(0,R.produce)(t,(e=>{e.query.mdx=r}));o(l)}}}),[v,s,o,t]),S=(0,a.useCallback)((e=>(C||[]).some((n=>p()(n,e)))),[C]),P=(0,a.useCallback)((()=>{if(s&&v&&w){const{orderMode:e,tupleCoordinates:n}=w,r=(0,E.HD)(s,{tupleCoordinates:n,orderMode:"ASC"===e?"DESC":"ASC"},v),l=(0,R.produce)(t,(e=>{e.query.mdx=r}));o(l)}}),[v,s,o,w,t]),O=(0,a.useCallback)((e=>i().createElement(M,u()({},e,{cube:v,sort:w,isExpanded:S,onSortChanged:P,mapping:t.mapping,onExpansionChanged:b}))),[v,b,S,t.mapping,w,P]);if((0,r.TS)(t.mapping))return i().createElement(d.P,{style:e.style});if(null==n?void 0:n.error){if((0,r.Z9)(n.error,"QueryTimeoutException"))throw new g.MB(n.error);throw new g.wb(n.error)}return i().createElement(y.$j,{isLoading:null==n?void 0:n.isLoading},(null==n?void 0:n.data)&&t.serverKey&&i().createElement(f.iA,{serverKey:t.serverKey,data:null==n?void 0:n.data,getBodyCellStyle:k,getHeaderCellStyle:A,headerCellComponent:O,onSelectionChange:l,containerStyle:e.style}))},H=(0,a.memo)(j,O)}}]);